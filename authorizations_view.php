<?php
// This script and data application were generated by AppGini 22.13
// Download AppGini for free from https://bigprof.com/appgini/download/

	include_once(__DIR__ . '/lib.php');
	@include_once(__DIR__ . '/hooks/authorizations.php');
	include_once(__DIR__ . '/authorizations_dml.php');

	// mm: can the current member access this page?
	$perm = getTablePermissions('authorizations');
	if(!$perm['access']) {
		echo error_message($Translation['tableAccessDenied']);
		exit;
	}

	$x = new DataList;
	$x->TableName = 'authorizations';

	// Fields that can be displayed in the table view
	$x->QueryFieldsTV = [
		"`authorizations`.`authorize_id`" => "authorize_id",
		"IF(    CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`claim_code`), '') /* Job/Claims Code: */" => "job_code",
		"IF(    CHAR_LENGTH(`claim_status1`.`claim_status`), CONCAT_WS('',   `claim_status1`.`claim_status`), '') /* Job/Claims  Status: */" => "job_status",
		"DATE_FORMAT(`authorizations`.`job_status_date`, '%D %b %Y %l:%i%p')" => "job_status_date",
		"`authorizations`.`job_status_age`" => "job_status_age",
		"`authorizations`.`job_age`" => "job_age",
		"IF(    CHAR_LENGTH(`claim_category1`.`claim_category`), CONCAT_WS('',   `claim_category1`.`claim_category`), '') /* Job/Claims  Category: */" => "job_category",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`), CONCAT_WS('',   `log_sheet1`.`closing_km`), '') /* Job/Claims  Odometer (km): */" => "job_odometer",
		"IF(    CHAR_LENGTH(`claim1`.`instruction_note`), CONCAT_WS('',   `claim1`.`instruction_note`), '') /* Instruction Note: */" => "instruction_note",
		"IF(    CHAR_LENGTH(if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), CONCAT_WS('',   if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), '') /* Pre Authorisation Date: */" => "pre_authorisation_date",
		"DATE_FORMAT(`authorizations`.`authorisation_date`, '%D %b %Y %l:%i%p')" => "authorisation_date",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register1`.`chassis_number`) || CHAR_LENGTH(`claim2`.`claim_code`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register1`.`chassis_number`, '    |   and   |', `claim2`.`claim_code`), '') /* Vehicle Registration: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`model_of_vehicle`) || CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`chassis_number`), CONCAT_WS('',   `gmt_fleet_register1`.`model_of_vehicle`, ' |   and    |    ', `gmt_fleet_register1`.`vehicle_registration_number`, `gmt_fleet_register3`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register3`.`chassis_number`), '') /* Model of Vehicle: */" => "make_of_vehicle",
		"IF(    CHAR_LENGTH(`departments1`.`department_name`) || CHAR_LENGTH(`claim3`.`client_identification`), CONCAT_WS('',   `departments1`.`department_name`, '   |    and    |   ', `claim3`.`client_identification`), '') /* Client: */" => "client",
		"IF(    CHAR_LENGTH(`province1`.`province`), CONCAT_WS('',   `province1`.`province`), '') /* Province Name: */" => "province_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_code`), '') /* Merchant Code: */" => "merchant_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_name`, '     |     and      |     ', `merchant1`.`merchant_code`), '') /* Merchant Name: */" => "merchant_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_email`), CONCAT_WS('',   `merchant1`.`merchant_contact_email`), '') /* Merchant Contact e-Mail: */" => "merchant_contact_email",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_street_address`), CONCAT_WS('',   `merchant1`.`merchant_street_address`), '') /* Merchant Street Address: */" => "merchant_street_address",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_suburb`), CONCAT_WS('',   `merchant1`.`merchant_suburb`), '') /* Merchant Suburb: */" => "merchant_suburb",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_city`), CONCAT_WS('',   `merchant1`.`merchant_city`), '') /* Merchant City: */" => "merchant_city",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_address_code`), CONCAT_WS('',   `merchant1`.`merchant_address_code`), '') /* Merchant Address Code: */" => "merchant_address_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_details`), CONCAT_WS('',   `merchant1`.`merchant_contact_details`), '') /* Merchant Phone: */" => "merchant_contact_details",
		"IF(    CHAR_LENGTH(`claim1`.`total_claimed`), CONCAT_WS('',   `claim1`.`total_claimed`), '') /* Total Amount Claim (R): */" => "total_claim",
		"IF(    CHAR_LENGTH(`claim1`.`total_authorized`), CONCAT_WS('',   `claim1`.`total_authorized`), '') /* Total Authorised (R): */" => "total_authorised",
		"IF(    CHAR_LENGTH(`claim1`.`authorization_number`) || CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`authorization_number`, '     |   and   |     ', `claim1`.`claim_code`), '') /* Authorization Number: */" => "authorization_number",
		"if(`authorizations`.`last_fuel_transaction_date`,date_format(`authorizations`.`last_fuel_transaction_date`,'%d/%m/%Y'),'')" => "last_fuel_transaction_date",
		"`authorizations`.`external_repairs`" => "external_repairs",
	];
	// mapping incoming sort by requests to actual query fields
	$x->SortFields = [
		1 => '`authorizations`.`authorize_id`',
		2 => '`claim1`.`claim_code`',
		3 => '`claim_status1`.`claim_status`',
		4 => '`authorizations`.`job_status_date`',
		5 => 5,
		6 => 6,
		7 => '`claim_category1`.`claim_category`',
		8 => 8,
		9 => '`claim1`.`instruction_note`',
		10 => 'date_format(`claim1`.`pre_authorization_date`,\'%d/%m/%Y\')',
		11 => '`authorizations`.`authorisation_date`',
		12 => 12,
		13 => 13,
		14 => 14,
		15 => '`province1`.`province`',
		16 => '`merchant1`.`merchant_code`',
		17 => 17,
		18 => '`merchant1`.`merchant_contact_email`',
		19 => '`merchant1`.`merchant_street_address`',
		20 => '`merchant1`.`merchant_suburb`',
		21 => '`merchant1`.`merchant_city`',
		22 => '`merchant1`.`merchant_address_code`',
		23 => '`merchant1`.`merchant_contact_details`',
		24 => '`claim1`.`total_claimed`',
		25 => '`claim1`.`total_authorized`',
		26 => 26,
		27 => '`authorizations`.`last_fuel_transaction_date`',
		28 => 28,
	];

	// Fields that can be displayed in the csv file
	$x->QueryFieldsCSV = [
		"`authorizations`.`authorize_id`" => "authorize_id",
		"IF(    CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`claim_code`), '') /* Job/Claims Code: */" => "job_code",
		"IF(    CHAR_LENGTH(`claim_status1`.`claim_status`), CONCAT_WS('',   `claim_status1`.`claim_status`), '') /* Job/Claims  Status: */" => "job_status",
		"DATE_FORMAT(`authorizations`.`job_status_date`, '%D %b %Y %l:%i%p')" => "job_status_date",
		"`authorizations`.`job_status_age`" => "job_status_age",
		"`authorizations`.`job_age`" => "job_age",
		"IF(    CHAR_LENGTH(`claim_category1`.`claim_category`), CONCAT_WS('',   `claim_category1`.`claim_category`), '') /* Job/Claims  Category: */" => "job_category",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`), CONCAT_WS('',   `log_sheet1`.`closing_km`), '') /* Job/Claims  Odometer (km): */" => "job_odometer",
		"IF(    CHAR_LENGTH(`claim1`.`instruction_note`), CONCAT_WS('',   `claim1`.`instruction_note`), '') /* Instruction Note: */" => "instruction_note",
		"IF(    CHAR_LENGTH(if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), CONCAT_WS('',   if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), '') /* Pre Authorisation Date: */" => "pre_authorisation_date",
		"DATE_FORMAT(`authorizations`.`authorisation_date`, '%D %b %Y %l:%i%p')" => "authorisation_date",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register1`.`chassis_number`) || CHAR_LENGTH(`claim2`.`claim_code`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register1`.`chassis_number`, '    |   and   |', `claim2`.`claim_code`), '') /* Vehicle Registration: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`model_of_vehicle`) || CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`chassis_number`), CONCAT_WS('',   `gmt_fleet_register1`.`model_of_vehicle`, ' |   and    |    ', `gmt_fleet_register1`.`vehicle_registration_number`, `gmt_fleet_register3`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register3`.`chassis_number`), '') /* Model of Vehicle: */" => "make_of_vehicle",
		"IF(    CHAR_LENGTH(`departments1`.`department_name`) || CHAR_LENGTH(`claim3`.`client_identification`), CONCAT_WS('',   `departments1`.`department_name`, '   |    and    |   ', `claim3`.`client_identification`), '') /* Client: */" => "client",
		"IF(    CHAR_LENGTH(`province1`.`province`), CONCAT_WS('',   `province1`.`province`), '') /* Province Name: */" => "province_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_code`), '') /* Merchant Code: */" => "merchant_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_name`, '     |     and      |     ', `merchant1`.`merchant_code`), '') /* Merchant Name: */" => "merchant_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_email`), CONCAT_WS('',   `merchant1`.`merchant_contact_email`), '') /* Merchant Contact e-Mail: */" => "merchant_contact_email",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_street_address`), CONCAT_WS('',   `merchant1`.`merchant_street_address`), '') /* Merchant Street Address: */" => "merchant_street_address",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_suburb`), CONCAT_WS('',   `merchant1`.`merchant_suburb`), '') /* Merchant Suburb: */" => "merchant_suburb",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_city`), CONCAT_WS('',   `merchant1`.`merchant_city`), '') /* Merchant City: */" => "merchant_city",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_address_code`), CONCAT_WS('',   `merchant1`.`merchant_address_code`), '') /* Merchant Address Code: */" => "merchant_address_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_details`), CONCAT_WS('',   `merchant1`.`merchant_contact_details`), '') /* Merchant Phone: */" => "merchant_contact_details",
		"IF(    CHAR_LENGTH(`claim1`.`total_claimed`), CONCAT_WS('',   `claim1`.`total_claimed`), '') /* Total Amount Claim (R): */" => "total_claim",
		"IF(    CHAR_LENGTH(`claim1`.`total_authorized`), CONCAT_WS('',   `claim1`.`total_authorized`), '') /* Total Authorised (R): */" => "total_authorised",
		"IF(    CHAR_LENGTH(`claim1`.`authorization_number`) || CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`authorization_number`, '     |   and   |     ', `claim1`.`claim_code`), '') /* Authorization Number: */" => "authorization_number",
		"if(`authorizations`.`last_fuel_transaction_date`,date_format(`authorizations`.`last_fuel_transaction_date`,'%d/%m/%Y'),'')" => "last_fuel_transaction_date",
		"`authorizations`.`external_repairs`" => "external_repairs",
	];
	// Fields that can be filtered
	$x->QueryFieldsFilters = [
		"`authorizations`.`authorize_id`" => "Authorize ID:",
		"IF(    CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`claim_code`), '') /* Job/Claims Code: */" => "Job/Claims Code:",
		"IF(    CHAR_LENGTH(`claim_status1`.`claim_status`), CONCAT_WS('',   `claim_status1`.`claim_status`), '') /* Job/Claims  Status: */" => "Job/Claims  Status:",
		"`authorizations`.`job_status_date`" => "Job/Claims  Status Date:",
		"`authorizations`.`job_status_age`" => "Job/Claims  Status Age:",
		"`authorizations`.`job_age`" => "Job/Claims Age:",
		"IF(    CHAR_LENGTH(`claim_category1`.`claim_category`), CONCAT_WS('',   `claim_category1`.`claim_category`), '') /* Job/Claims  Category: */" => "Job/Claims  Category:",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`), CONCAT_WS('',   `log_sheet1`.`closing_km`), '') /* Job/Claims  Odometer (km): */" => "Job/Claims  Odometer (km):",
		"IF(    CHAR_LENGTH(`claim1`.`instruction_note`), CONCAT_WS('',   `claim1`.`instruction_note`), '') /* Instruction Note: */" => "Instruction Note:",
		"IF(    CHAR_LENGTH(if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), CONCAT_WS('',   if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), '') /* Pre Authorisation Date: */" => "Pre Authorisation Date:",
		"`authorizations`.`authorisation_date`" => "Authorisation Date:",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register1`.`chassis_number`) || CHAR_LENGTH(`claim2`.`claim_code`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register1`.`chassis_number`, '    |   and   |', `claim2`.`claim_code`), '') /* Vehicle Registration: */" => "Vehicle Registration:",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`model_of_vehicle`) || CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`chassis_number`), CONCAT_WS('',   `gmt_fleet_register1`.`model_of_vehicle`, ' |   and    |    ', `gmt_fleet_register1`.`vehicle_registration_number`, `gmt_fleet_register3`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register3`.`chassis_number`), '') /* Model of Vehicle: */" => "Model of Vehicle:",
		"IF(    CHAR_LENGTH(`departments1`.`department_name`) || CHAR_LENGTH(`claim3`.`client_identification`), CONCAT_WS('',   `departments1`.`department_name`, '   |    and    |   ', `claim3`.`client_identification`), '') /* Client: */" => "Client:",
		"IF(    CHAR_LENGTH(`province1`.`province`), CONCAT_WS('',   `province1`.`province`), '') /* Province Name: */" => "Province Name:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_code`), '') /* Merchant Code: */" => "Merchant Code:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_name`, '     |     and      |     ', `merchant1`.`merchant_code`), '') /* Merchant Name: */" => "Merchant Name:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_email`), CONCAT_WS('',   `merchant1`.`merchant_contact_email`), '') /* Merchant Contact e-Mail: */" => "Merchant Contact e-Mail:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_street_address`), CONCAT_WS('',   `merchant1`.`merchant_street_address`), '') /* Merchant Street Address: */" => "Merchant Street Address:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_suburb`), CONCAT_WS('',   `merchant1`.`merchant_suburb`), '') /* Merchant Suburb: */" => "Merchant Suburb:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_city`), CONCAT_WS('',   `merchant1`.`merchant_city`), '') /* Merchant City: */" => "Merchant City:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_address_code`), CONCAT_WS('',   `merchant1`.`merchant_address_code`), '') /* Merchant Address Code: */" => "Merchant Address Code:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_details`), CONCAT_WS('',   `merchant1`.`merchant_contact_details`), '') /* Merchant Phone: */" => "Merchant Phone:",
		"IF(    CHAR_LENGTH(`claim1`.`total_claimed`), CONCAT_WS('',   `claim1`.`total_claimed`), '') /* Total Amount Claim (R): */" => "Total Amount Claim (R):",
		"IF(    CHAR_LENGTH(`claim1`.`total_authorized`), CONCAT_WS('',   `claim1`.`total_authorized`), '') /* Total Authorised (R): */" => "Total Authorised (R):",
		"IF(    CHAR_LENGTH(`claim1`.`authorization_number`) || CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`authorization_number`, '     |   and   |     ', `claim1`.`claim_code`), '') /* Authorization Number: */" => "Authorization Number:",
		"`authorizations`.`last_fuel_transaction_date`" => "Last Fuel Transaction Date:",
		"`authorizations`.`external_repairs`" => "External Repairs:",
	];

	// Fields that can be quick searched
	$x->QueryFieldsQS = [
		"`authorizations`.`authorize_id`" => "authorize_id",
		"IF(    CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`claim_code`), '') /* Job/Claims Code: */" => "job_code",
		"IF(    CHAR_LENGTH(`claim_status1`.`claim_status`), CONCAT_WS('',   `claim_status1`.`claim_status`), '') /* Job/Claims  Status: */" => "job_status",
		"DATE_FORMAT(`authorizations`.`job_status_date`, '%D %b %Y %l:%i%p')" => "job_status_date",
		"`authorizations`.`job_status_age`" => "job_status_age",
		"`authorizations`.`job_age`" => "job_age",
		"IF(    CHAR_LENGTH(`claim_category1`.`claim_category`), CONCAT_WS('',   `claim_category1`.`claim_category`), '') /* Job/Claims  Category: */" => "job_category",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`), CONCAT_WS('',   `log_sheet1`.`closing_km`), '') /* Job/Claims  Odometer (km): */" => "job_odometer",
		"IF(    CHAR_LENGTH(`claim1`.`instruction_note`), CONCAT_WS('',   `claim1`.`instruction_note`), '') /* Instruction Note: */" => "instruction_note",
		"IF(    CHAR_LENGTH(if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), CONCAT_WS('',   if(`claim1`.`pre_authorization_date`,date_format(`claim1`.`pre_authorization_date`,'%d/%m/%Y'),'')), '') /* Pre Authorisation Date: */" => "pre_authorisation_date",
		"DATE_FORMAT(`authorizations`.`authorisation_date`, '%D %b %Y %l:%i%p')" => "authorisation_date",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register1`.`chassis_number`) || CHAR_LENGTH(`claim2`.`claim_code`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register1`.`chassis_number`, '    |   and   |', `claim2`.`claim_code`), '') /* Vehicle Registration: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`model_of_vehicle`) || CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`vehicle_registration_number`) || CHAR_LENGTH(`gmt_fleet_register3`.`chassis_number`), CONCAT_WS('',   `gmt_fleet_register1`.`model_of_vehicle`, ' |   and    |    ', `gmt_fleet_register1`.`vehicle_registration_number`, `gmt_fleet_register3`.`vehicle_registration_number`, '    |   and    |  ', `gmt_fleet_register3`.`chassis_number`), '') /* Model of Vehicle: */" => "make_of_vehicle",
		"IF(    CHAR_LENGTH(`departments1`.`department_name`) || CHAR_LENGTH(`claim3`.`client_identification`), CONCAT_WS('',   `departments1`.`department_name`, '   |    and    |   ', `claim3`.`client_identification`), '') /* Client: */" => "client",
		"IF(    CHAR_LENGTH(`province1`.`province`), CONCAT_WS('',   `province1`.`province`), '') /* Province Name: */" => "province_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_code`), '') /* Merchant Code: */" => "merchant_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant1`.`merchant_code`), CONCAT_WS('',   `merchant1`.`merchant_name`, '     |     and      |     ', `merchant1`.`merchant_code`), '') /* Merchant Name: */" => "merchant_name",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_email`), CONCAT_WS('',   `merchant1`.`merchant_contact_email`), '') /* Merchant Contact e-Mail: */" => "merchant_contact_email",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_street_address`), CONCAT_WS('',   `merchant1`.`merchant_street_address`), '') /* Merchant Street Address: */" => "merchant_street_address",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_suburb`), CONCAT_WS('',   `merchant1`.`merchant_suburb`), '') /* Merchant Suburb: */" => "merchant_suburb",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_city`), CONCAT_WS('',   `merchant1`.`merchant_city`), '') /* Merchant City: */" => "merchant_city",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_address_code`), CONCAT_WS('',   `merchant1`.`merchant_address_code`), '') /* Merchant Address Code: */" => "merchant_address_code",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_contact_details`), CONCAT_WS('',   `merchant1`.`merchant_contact_details`), '') /* Merchant Phone: */" => "merchant_contact_details",
		"IF(    CHAR_LENGTH(`claim1`.`total_claimed`), CONCAT_WS('',   `claim1`.`total_claimed`), '') /* Total Amount Claim (R): */" => "total_claim",
		"IF(    CHAR_LENGTH(`claim1`.`total_authorized`), CONCAT_WS('',   `claim1`.`total_authorized`), '') /* Total Authorised (R): */" => "total_authorised",
		"IF(    CHAR_LENGTH(`claim1`.`authorization_number`) || CHAR_LENGTH(`claim1`.`claim_code`), CONCAT_WS('',   `claim1`.`authorization_number`, '     |   and   |     ', `claim1`.`claim_code`), '') /* Authorization Number: */" => "authorization_number",
		"if(`authorizations`.`last_fuel_transaction_date`,date_format(`authorizations`.`last_fuel_transaction_date`,'%d/%m/%Y'),'')" => "last_fuel_transaction_date",
		"`authorizations`.`external_repairs`" => "external_repairs",
	];

	// Lookup fields that can be used as filterers
	$x->filterers = ['job_code' => 'Job/Claims Code:', 'job_status' => 'Job/Claims  Status:', 'job_category' => 'Job/Claims  Category:', 'vehicle_registration_number' => 'Vehicle Registration:', 'client' => 'Client:', 'province_name' => 'Province Name:', 'merchant_code' => 'Merchant Code:', ];

	$x->QueryFrom = "`authorizations` LEFT JOIN `claim` as claim1 ON `claim1`.`claim_id`=`authorizations`.`job_code` LEFT JOIN `claim_status` as claim_status1 ON `claim_status1`.`claim_status_id`=`authorizations`.`job_status` LEFT JOIN `claim_category` as claim_category1 ON `claim_category1`.`claim_category_id`=`authorizations`.`job_category` LEFT JOIN `claim` as claim2 ON `claim2`.`claim_id`=`authorizations`.`vehicle_registration_number` LEFT JOIN `gmt_fleet_register` as gmt_fleet_register1 ON `gmt_fleet_register1`.`fleet_asset_id`=`claim2`.`vehicle_registration_number` LEFT JOIN `claim` as claim3 ON `claim3`.`claim_id`=`authorizations`.`client` LEFT JOIN `departments` as departments1 ON `departments1`.`department_id`=`claim3`.`department_name` LEFT JOIN `province` as province1 ON `province1`.`province_id`=`authorizations`.`province_name` LEFT JOIN `merchant` as merchant1 ON `merchant1`.`merchant_id`=`authorizations`.`merchant_code` LEFT JOIN `log_sheet` as log_sheet1 ON `log_sheet1`.`fuel_log_sheet_id`=`claim1`.`closing_km` LEFT JOIN `gmt_fleet_register` as gmt_fleet_register3 ON `gmt_fleet_register3`.`fleet_asset_id`=`claim1`.`vehicle_registration_number` ";
	$x->QueryWhere = '';
	$x->QueryOrder = '';

	$x->AllowSelection = 1;
	$x->HideTableView = ($perm['view'] == 0 ? 1 : 0);
	$x->AllowDelete = $perm['delete'];
	$x->AllowMassDelete = (getLoggedAdmin() !== false);
	$x->AllowInsert = $perm['insert'];
	$x->AllowUpdate = $perm['edit'];
	$x->SeparateDV = 1;
	$x->AllowDeleteOfParents = 0;
	$x->AllowFilters = 1;
	$x->AllowSavingFilters = (getLoggedAdmin() !== false);
	$x->AllowSorting = 1;
	$x->AllowNavigation = 1;
	$x->AllowPrinting = 1;
	$x->AllowPrintingDV = 1;
	$x->AllowCSV = 1;
	$x->RecordsPerPage = 25;
	$x->QuickSearch = 1;
	$x->QuickSearchText = $Translation['quick search'];
	$x->ScriptFileName = 'authorizations_view.php';
	$x->RedirectAfterInsert = 'authorizations_view.php?SelectedID=#ID#';
	$x->TableTitle = 'Authorization Report:';
	$x->TableIcon = 'resources/table_icons/lesson_planning_128.png';
	$x->PrimaryKey = '`authorizations`.`authorize_id`';

	$x->ColWidth = [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, ];
	$x->ColCaption = ['Authorize ID:', 'Job/Claims Code:', 'Job/Claims  Status:', 'Job/Claims  Status Date:', 'Job/Claims  Status Age:', 'Job/Claims Age:', 'Job/Claims  Category:', 'Job/Claims  Odometer (km):', 'Instruction Note:', 'Pre Authorisation Date:', 'Authorisation Date:', 'Vehicle Registration:', 'Model of Vehicle:', 'Client:', 'Province Name:', 'Merchant Code:', 'Merchant Name:', 'Merchant Contact e-Mail:', 'Merchant Street Address:', 'Merchant Suburb:', 'Merchant City:', 'Merchant Address Code:', 'Merchant Phone:', 'Total Amount Claim (R):', 'Total Authorised (R):', 'Authorization Number:', 'Last Fuel Transaction Date:', 'External Repairs:', ];
	$x->ColFieldName = ['authorize_id', 'job_code', 'job_status', 'job_status_date', 'job_status_age', 'job_age', 'job_category', 'job_odometer', 'instruction_note', 'pre_authorisation_date', 'authorisation_date', 'vehicle_registration_number', 'make_of_vehicle', 'client', 'province_name', 'merchant_code', 'merchant_name', 'merchant_contact_email', 'merchant_street_address', 'merchant_suburb', 'merchant_city', 'merchant_address_code', 'merchant_contact_details', 'total_claim', 'total_authorised', 'authorization_number', 'last_fuel_transaction_date', 'external_repairs', ];
	$x->ColNumber  = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, ];

	// template paths below are based on the app main directory
	$x->Template = 'templates/authorizations_templateTV.html';
	$x->SelectedTemplate = 'templates/authorizations_templateTVS.html';
	$x->TemplateDV = 'templates/authorizations_templateDV.html';
	$x->TemplateDVP = 'templates/authorizations_templateDVP.html';

	$x->ShowTableHeader = 1;
	$x->TVClasses = "";
	$x->DVClasses = "";
	$x->HasCalculatedFields = false;
	$x->AllowConsoleLog = false;
	$x->AllowDVNavigation = true;

	// hook: authorizations_init
	$render = true;
	if(function_exists('authorizations_init')) {
		$args = [];
		$render = authorizations_init($x, getMemberInfo(), $args);
	}

	if($render) $x->Render();

	// hook: authorizations_header
	$headerCode = '';
	if(function_exists('authorizations_header')) {
		$args = [];
		$headerCode = authorizations_header($x->ContentType, getMemberInfo(), $args);
	}

	if(!$headerCode) {
		include_once(__DIR__ . '/header.php'); 
	} else {
		ob_start();
		include_once(__DIR__ . '/header.php');
		echo str_replace('<%%HEADER%%>', ob_get_clean(), $headerCode);
	}

	echo $x->HTML;

	// hook: authorizations_footer
	$footerCode = '';
	if(function_exists('authorizations_footer')) {
		$args = [];
		$footerCode = authorizations_footer($x->ContentType, getMemberInfo(), $args);
	}

	if(!$footerCode) {
		include_once(__DIR__ . '/footer.php'); 
	} else {
		ob_start();
		include_once(__DIR__ . '/footer.php');
		echo str_replace('<%%FOOTER%%>', ob_get_clean(), $footerCode);
	}
