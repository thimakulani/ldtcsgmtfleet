<?php
// This script and data application were generated by AppGini 22.13
// Download AppGini for free from https://bigprof.com/appgini/download/

	include_once(__DIR__ . '/lib.php');
	@include_once(__DIR__ . '/hooks/purchase_orders.php');
	include_once(__DIR__ . '/purchase_orders_dml.php');

	// mm: can the current member access this page?
	$perm = getTablePermissions('purchase_orders');
	if(!$perm['access']) {
		echo error_message($Translation['tableAccessDenied']);
		exit;
	}

	$x = new DataList;
	$x->TableName = 'purchase_orders';

	// Fields that can be displayed in the table view
	$x->QueryFieldsTV = [
		"`purchase_orders`.`purchase_order_id`" => "purchase_order_id",
		"`purchase_orders`.`purchased_order_number`" => "purchased_order_number",
		"if(`purchase_orders`.`purchased_date`,date_format(`purchase_orders`.`purchased_date`,'%d/%m/%Y'),'')" => "purchased_date",
		"`purchase_orders`.`purchaser`" => "purchaser",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, ' '), '') /* Registration Number: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`body_type1`.`type_of_vehicle`), CONCAT_WS('',   `body_type1`.`type_of_vehicle`), '') /* Type of Vehicle: */" => "type_of_vehicle",
		"IF(    CHAR_LENGTH(`manufacturer1`.`manufacturer_name`), CONCAT_WS('',   `manufacturer1`.`manufacturer_name`), '') /* Manufacturer: */" => "manufacturer",
		"`purchase_orders`.`service_type`" => "service_type",
		"IF(    CHAR_LENGTH(`service_categories1`.`service_category`), CONCAT_WS('',   `service_categories1`.`service_category`), '') /* Service Category: */" => "service_category",
		"`purchase_orders`.`service_item`" => "service_item",
		"`purchase_orders`.`upload_quotation`" => "upload_quotation",
		"if(`purchase_orders`.`due_date`,date_format(`purchase_orders`.`due_date`,'%d/%m/%Y'),'')" => "due_date",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant_type1`.`merchant_type`), CONCAT_WS('',   `merchant1`.`merchant_name`, '    |   and   |    ', `merchant_type1`.`merchant_type`), '') /* Merchant Name: */" => "merchant_name",
		"DATE_FORMAT(`purchase_orders`.`date_of_service`, '%D %b %Y %l:%i%p')" => "date_of_service",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`) || CHAR_LENGTH(`log_sheet1`.`fuel_log_sheet_id`), CONCAT_WS('',   `log_sheet1`.`closing_km`, '      |    and    |    ', `log_sheet1`.`fuel_log_sheet_id`), '') /* Odometer Reading (km): */" => "closing_km",
		"`purchase_orders`.`labour_category_1`" => "labour_category_1",
		"IF(    CHAR_LENGTH(`parts1`.`part_number`), CONCAT_WS('',   `parts1`.`part_number`), '') /* Part Number (1): */" => "part_number_1",
		"IF(    CHAR_LENGTH(`parts2`.`part_name`), CONCAT_WS('',   `parts2`.`part_name`), '') /* Part Name (1): */" => "part_name_1",
		"IF(    CHAR_LENGTH(`manufacturer2`.`manufacturer_name`), CONCAT_WS('',   `manufacturer2`.`manufacturer_name`), '') /* Part Manufacturer Name (1): */" => "part_manufacturer_name_1",
		"`purchase_orders`.`quantity_1`" => "quantity_1",
		"`purchase_orders`.`expense_of_item_1`" => "expense_of_item_1",
		"`purchase_orders`.`labour_category_2`" => "labour_category_2",
		"IF(    CHAR_LENGTH(`parts3`.`part_number`), CONCAT_WS('',   `parts3`.`part_number`), '') /* Part Number (2): */" => "part_number_2",
		"IF(    CHAR_LENGTH(`parts4`.`part_name`), CONCAT_WS('',   `parts4`.`part_name`), '') /* Part Name (2): */" => "part_name_2",
		"IF(    CHAR_LENGTH(`manufacturer3`.`manufacturer_name`), CONCAT_WS('',   `manufacturer3`.`manufacturer_name`), '') /* Part Manufacturer Name (2): */" => "part_manufacturer_name_2",
		"`purchase_orders`.`quantity_2`" => "quantity_2",
		"`purchase_orders`.`expense_of_item_2`" => "expense_of_item_2",
		"`purchase_orders`.`labour_category_3`" => "labour_category_3",
		"IF(    CHAR_LENGTH(`parts5`.`part_number`), CONCAT_WS('',   `parts5`.`part_number`), '') /* Part Number (3): */" => "part_number_3",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (3): */" => "part_name_3",
		"IF(    CHAR_LENGTH(`manufacturer4`.`manufacturer_name`), CONCAT_WS('',   `manufacturer4`.`manufacturer_name`), '') /* Part Manufacturer Name (3): */" => "part_manufacturer_name_3",
		"`purchase_orders`.`quantity_3`" => "quantity_3",
		"`purchase_orders`.`expense_of_item_3`" => "expense_of_item_3",
		"`purchase_orders`.`labour_category_4`" => "labour_category_4",
		"IF(    CHAR_LENGTH(`parts6`.`part_number`), CONCAT_WS('',   `parts6`.`part_number`), '') /* Part Number (4): */" => "part_number_4",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (4): */" => "part_name_4",
		"IF(    CHAR_LENGTH(`manufacturer5`.`manufacturer_name`), CONCAT_WS('',   `manufacturer5`.`manufacturer_name`), '') /* Part Manufacturer Name  (4): */" => "part_manufacturer_name_4",
		"`purchase_orders`.`quantity_4`" => "quantity_4",
		"`purchase_orders`.`expense_of_item_4`" => "expense_of_item_4",
		"`purchase_orders`.`labour_category_5`" => "labour_category_5",
		"IF(    CHAR_LENGTH(`parts7`.`part_number`), CONCAT_WS('',   `parts7`.`part_number`), '') /* Part Number (5): */" => "part_number_5",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (5): */" => "part_name_5",
		"IF(    CHAR_LENGTH(`manufacturer6`.`manufacturer_name`), CONCAT_WS('',   `manufacturer6`.`manufacturer_name`), '') /* Part Manufacturer Name (5): */" => "part_manufacturer_name_5",
		"`purchase_orders`.`quantity_5`" => "quantity_5",
		"`purchase_orders`.`expense_of_item_5`" => "expense_of_item_5",
		"`purchase_orders`.`labour_category_6`" => "labour_category_6",
		"IF(    CHAR_LENGTH(`parts8`.`part_number`), CONCAT_WS('',   `parts8`.`part_number`), '') /* Part Number (6): */" => "part_number_6",
		"IF(    CHAR_LENGTH(`parts9`.`part_name`), CONCAT_WS('',   `parts9`.`part_name`), '') /* Part Name (6): */" => "part_name_6",
		"IF(    CHAR_LENGTH(`manufacturer7`.`manufacturer_name`), CONCAT_WS('',   `manufacturer7`.`manufacturer_name`), '') /* Part Manufacturer Name (6): */" => "part_manufacturer_name_6",
		"`purchase_orders`.`quantity_6`" => "quantity_6",
		"`purchase_orders`.`expense_of_item_6`" => "expense_of_item_6",
		"`purchase_orders`.`labour_category_7`" => "labour_category_7",
		"IF(    CHAR_LENGTH(`parts10`.`part_number`), CONCAT_WS('',   `parts10`.`part_number`), '') /* Part Number (7): */" => "part_number_7",
		"IF(    CHAR_LENGTH(`parts11`.`part_name`), CONCAT_WS('',   `parts11`.`part_name`), '') /* Part Name (7): */" => "part_name_7",
		"IF(    CHAR_LENGTH(`manufacturer8`.`manufacturer_name`), CONCAT_WS('',   `manufacturer8`.`manufacturer_name`), '') /* Part Manufacturer Name (7): */" => "part_manufacturer_name_7",
		"`purchase_orders`.`quantity_7`" => "quantity_7",
		"`purchase_orders`.`expense_of_item_7`" => "expense_of_item_7",
		"`purchase_orders`.`labour_category_8`" => "labour_category_8",
		"IF(    CHAR_LENGTH(`parts12`.`part_number`), CONCAT_WS('',   `parts12`.`part_number`), '') /* Part Number (8): */" => "part_number_8",
		"IF(    CHAR_LENGTH(`parts13`.`part_number`), CONCAT_WS('',   `parts13`.`part_number`), '') /* Part Name (8): */" => "part_name_8",
		"IF(    CHAR_LENGTH(`manufacturer9`.`manufacturer_name`), CONCAT_WS('',   `manufacturer9`.`manufacturer_name`), '') /* Part Manufacturer Name (8): */" => "part_manufacturer_name_8",
		"`purchase_orders`.`expense_of_item_8`" => "expense_of_item_8",
		"`purchase_orders`.`material_cost`" => "material_cost",
		"`purchase_orders`.`average_worktime_hrs`" => "average_worktime_hrs",
		"`purchase_orders`.`standard_labour_cost_per_hour`" => "standard_labour_cost_per_hour",
		"`purchase_orders`.`labour_charges`" => "labour_charges",
		"`purchase_orders`.`vat`" => "vat",
		"`purchase_orders`.`total_amount`" => "total_amount",
		"IF(    CHAR_LENGTH(`service1`.`workshop_name`), CONCAT_WS('',   `service1`.`workshop_name`), '') /* Workshop Name: */" => "workshop_name",
		"IF(    CHAR_LENGTH(`service2`.`service_id`), CONCAT_WS('',   `service2`.`service_id`), '') /* Work Order ID: */" => "work_order_id",
		"IF(    CHAR_LENGTH(`reception1`.`job_card_number`), CONCAT_WS('',   `reception1`.`job_card_number`), '') /* Job Card Number: */" => "job_card_number",
		"if(`purchase_orders`.`completion_date`,date_format(`purchase_orders`.`completion_date`,'%d/%m/%Y'),'')" => "completion_date",
		"`purchase_orders`.`comments`" => "comments",
		"`purchase_orders`.`upload_invoice`" => "upload_invoice",
		"if(`purchase_orders`.`date_captured`,date_format(`purchase_orders`.`date_captured`,'%d/%m/%Y'),'')" => "date_captured",
		"`purchase_orders`.`data_capturer`" => "data_capturer",
		"`purchase_orders`.`data_capturer_contact_email`" => "data_capturer_contact_email",
	];
	// mapping incoming sort by requests to actual query fields
	$x->SortFields = [
		1 => '`purchase_orders`.`purchase_order_id`',
		2 => 2,
		3 => '`purchase_orders`.`purchased_date`',
		4 => 4,
		5 => 5,
		6 => 6,
		7 => '`manufacturer1`.`manufacturer_name`',
		8 => 8,
		9 => '`service_categories1`.`service_category`',
		10 => 10,
		11 => 11,
		12 => '`purchase_orders`.`due_date`',
		13 => 13,
		14 => '`purchase_orders`.`date_of_service`',
		15 => 15,
		16 => 16,
		17 => '`parts1`.`part_number`',
		18 => '`parts2`.`part_name`',
		19 => '`manufacturer2`.`manufacturer_name`',
		20 => 20,
		21 => '`purchase_orders`.`expense_of_item_1`',
		22 => 22,
		23 => '`parts3`.`part_number`',
		24 => '`parts4`.`part_name`',
		25 => '`manufacturer3`.`manufacturer_name`',
		26 => 26,
		27 => '`purchase_orders`.`expense_of_item_2`',
		28 => 28,
		29 => '`parts5`.`part_number`',
		30 => '`parts1`.`part_name`',
		31 => '`manufacturer4`.`manufacturer_name`',
		32 => 32,
		33 => '`purchase_orders`.`expense_of_item_3`',
		34 => 34,
		35 => '`parts6`.`part_number`',
		36 => '`parts1`.`part_name`',
		37 => '`manufacturer5`.`manufacturer_name`',
		38 => 38,
		39 => '`purchase_orders`.`expense_of_item_4`',
		40 => 40,
		41 => '`parts7`.`part_number`',
		42 => '`parts1`.`part_name`',
		43 => '`manufacturer6`.`manufacturer_name`',
		44 => 44,
		45 => '`purchase_orders`.`expense_of_item_5`',
		46 => 46,
		47 => '`parts8`.`part_number`',
		48 => '`parts9`.`part_name`',
		49 => '`manufacturer7`.`manufacturer_name`',
		50 => 50,
		51 => '`purchase_orders`.`expense_of_item_6`',
		52 => 52,
		53 => '`parts10`.`part_number`',
		54 => '`parts11`.`part_name`',
		55 => '`manufacturer8`.`manufacturer_name`',
		56 => 56,
		57 => '`purchase_orders`.`expense_of_item_7`',
		58 => 58,
		59 => '`parts12`.`part_number`',
		60 => '`parts13`.`part_number`',
		61 => '`manufacturer9`.`manufacturer_name`',
		62 => '`purchase_orders`.`expense_of_item_8`',
		63 => '`purchase_orders`.`material_cost`',
		64 => 64,
		65 => '`purchase_orders`.`standard_labour_cost_per_hour`',
		66 => '`purchase_orders`.`labour_charges`',
		67 => '`purchase_orders`.`vat`',
		68 => '`purchase_orders`.`total_amount`',
		69 => 69,
		70 => '`service2`.`service_id`',
		71 => '`reception1`.`job_card_number`',
		72 => '`purchase_orders`.`completion_date`',
		73 => 73,
		74 => 74,
		75 => '`purchase_orders`.`date_captured`',
		76 => 76,
		77 => 77,
	];

	// Fields that can be displayed in the csv file
	$x->QueryFieldsCSV = [
		"`purchase_orders`.`purchase_order_id`" => "purchase_order_id",
		"`purchase_orders`.`purchased_order_number`" => "purchased_order_number",
		"if(`purchase_orders`.`purchased_date`,date_format(`purchase_orders`.`purchased_date`,'%d/%m/%Y'),'')" => "purchased_date",
		"`purchase_orders`.`purchaser`" => "purchaser",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, ' '), '') /* Registration Number: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`body_type1`.`type_of_vehicle`), CONCAT_WS('',   `body_type1`.`type_of_vehicle`), '') /* Type of Vehicle: */" => "type_of_vehicle",
		"IF(    CHAR_LENGTH(`manufacturer1`.`manufacturer_name`), CONCAT_WS('',   `manufacturer1`.`manufacturer_name`), '') /* Manufacturer: */" => "manufacturer",
		"`purchase_orders`.`service_type`" => "service_type",
		"IF(    CHAR_LENGTH(`service_categories1`.`service_category`), CONCAT_WS('',   `service_categories1`.`service_category`), '') /* Service Category: */" => "service_category",
		"`purchase_orders`.`service_item`" => "service_item",
		"`purchase_orders`.`upload_quotation`" => "upload_quotation",
		"if(`purchase_orders`.`due_date`,date_format(`purchase_orders`.`due_date`,'%d/%m/%Y'),'')" => "due_date",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant_type1`.`merchant_type`), CONCAT_WS('',   `merchant1`.`merchant_name`, '    |   and   |    ', `merchant_type1`.`merchant_type`), '') /* Merchant Name: */" => "merchant_name",
		"DATE_FORMAT(`purchase_orders`.`date_of_service`, '%D %b %Y %l:%i%p')" => "date_of_service",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`) || CHAR_LENGTH(`log_sheet1`.`fuel_log_sheet_id`), CONCAT_WS('',   `log_sheet1`.`closing_km`, '      |    and    |    ', `log_sheet1`.`fuel_log_sheet_id`), '') /* Odometer Reading (km): */" => "closing_km",
		"`purchase_orders`.`labour_category_1`" => "labour_category_1",
		"IF(    CHAR_LENGTH(`parts1`.`part_number`), CONCAT_WS('',   `parts1`.`part_number`), '') /* Part Number (1): */" => "part_number_1",
		"IF(    CHAR_LENGTH(`parts2`.`part_name`), CONCAT_WS('',   `parts2`.`part_name`), '') /* Part Name (1): */" => "part_name_1",
		"IF(    CHAR_LENGTH(`manufacturer2`.`manufacturer_name`), CONCAT_WS('',   `manufacturer2`.`manufacturer_name`), '') /* Part Manufacturer Name (1): */" => "part_manufacturer_name_1",
		"`purchase_orders`.`quantity_1`" => "quantity_1",
		"`purchase_orders`.`expense_of_item_1`" => "expense_of_item_1",
		"`purchase_orders`.`labour_category_2`" => "labour_category_2",
		"IF(    CHAR_LENGTH(`parts3`.`part_number`), CONCAT_WS('',   `parts3`.`part_number`), '') /* Part Number (2): */" => "part_number_2",
		"IF(    CHAR_LENGTH(`parts4`.`part_name`), CONCAT_WS('',   `parts4`.`part_name`), '') /* Part Name (2): */" => "part_name_2",
		"IF(    CHAR_LENGTH(`manufacturer3`.`manufacturer_name`), CONCAT_WS('',   `manufacturer3`.`manufacturer_name`), '') /* Part Manufacturer Name (2): */" => "part_manufacturer_name_2",
		"`purchase_orders`.`quantity_2`" => "quantity_2",
		"`purchase_orders`.`expense_of_item_2`" => "expense_of_item_2",
		"`purchase_orders`.`labour_category_3`" => "labour_category_3",
		"IF(    CHAR_LENGTH(`parts5`.`part_number`), CONCAT_WS('',   `parts5`.`part_number`), '') /* Part Number (3): */" => "part_number_3",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (3): */" => "part_name_3",
		"IF(    CHAR_LENGTH(`manufacturer4`.`manufacturer_name`), CONCAT_WS('',   `manufacturer4`.`manufacturer_name`), '') /* Part Manufacturer Name (3): */" => "part_manufacturer_name_3",
		"`purchase_orders`.`quantity_3`" => "quantity_3",
		"`purchase_orders`.`expense_of_item_3`" => "expense_of_item_3",
		"`purchase_orders`.`labour_category_4`" => "labour_category_4",
		"IF(    CHAR_LENGTH(`parts6`.`part_number`), CONCAT_WS('',   `parts6`.`part_number`), '') /* Part Number (4): */" => "part_number_4",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (4): */" => "part_name_4",
		"IF(    CHAR_LENGTH(`manufacturer5`.`manufacturer_name`), CONCAT_WS('',   `manufacturer5`.`manufacturer_name`), '') /* Part Manufacturer Name  (4): */" => "part_manufacturer_name_4",
		"`purchase_orders`.`quantity_4`" => "quantity_4",
		"`purchase_orders`.`expense_of_item_4`" => "expense_of_item_4",
		"`purchase_orders`.`labour_category_5`" => "labour_category_5",
		"IF(    CHAR_LENGTH(`parts7`.`part_number`), CONCAT_WS('',   `parts7`.`part_number`), '') /* Part Number (5): */" => "part_number_5",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (5): */" => "part_name_5",
		"IF(    CHAR_LENGTH(`manufacturer6`.`manufacturer_name`), CONCAT_WS('',   `manufacturer6`.`manufacturer_name`), '') /* Part Manufacturer Name (5): */" => "part_manufacturer_name_5",
		"`purchase_orders`.`quantity_5`" => "quantity_5",
		"`purchase_orders`.`expense_of_item_5`" => "expense_of_item_5",
		"`purchase_orders`.`labour_category_6`" => "labour_category_6",
		"IF(    CHAR_LENGTH(`parts8`.`part_number`), CONCAT_WS('',   `parts8`.`part_number`), '') /* Part Number (6): */" => "part_number_6",
		"IF(    CHAR_LENGTH(`parts9`.`part_name`), CONCAT_WS('',   `parts9`.`part_name`), '') /* Part Name (6): */" => "part_name_6",
		"IF(    CHAR_LENGTH(`manufacturer7`.`manufacturer_name`), CONCAT_WS('',   `manufacturer7`.`manufacturer_name`), '') /* Part Manufacturer Name (6): */" => "part_manufacturer_name_6",
		"`purchase_orders`.`quantity_6`" => "quantity_6",
		"`purchase_orders`.`expense_of_item_6`" => "expense_of_item_6",
		"`purchase_orders`.`labour_category_7`" => "labour_category_7",
		"IF(    CHAR_LENGTH(`parts10`.`part_number`), CONCAT_WS('',   `parts10`.`part_number`), '') /* Part Number (7): */" => "part_number_7",
		"IF(    CHAR_LENGTH(`parts11`.`part_name`), CONCAT_WS('',   `parts11`.`part_name`), '') /* Part Name (7): */" => "part_name_7",
		"IF(    CHAR_LENGTH(`manufacturer8`.`manufacturer_name`), CONCAT_WS('',   `manufacturer8`.`manufacturer_name`), '') /* Part Manufacturer Name (7): */" => "part_manufacturer_name_7",
		"`purchase_orders`.`quantity_7`" => "quantity_7",
		"`purchase_orders`.`expense_of_item_7`" => "expense_of_item_7",
		"`purchase_orders`.`labour_category_8`" => "labour_category_8",
		"IF(    CHAR_LENGTH(`parts12`.`part_number`), CONCAT_WS('',   `parts12`.`part_number`), '') /* Part Number (8): */" => "part_number_8",
		"IF(    CHAR_LENGTH(`parts13`.`part_number`), CONCAT_WS('',   `parts13`.`part_number`), '') /* Part Name (8): */" => "part_name_8",
		"IF(    CHAR_LENGTH(`manufacturer9`.`manufacturer_name`), CONCAT_WS('',   `manufacturer9`.`manufacturer_name`), '') /* Part Manufacturer Name (8): */" => "part_manufacturer_name_8",
		"`purchase_orders`.`expense_of_item_8`" => "expense_of_item_8",
		"`purchase_orders`.`material_cost`" => "material_cost",
		"`purchase_orders`.`average_worktime_hrs`" => "average_worktime_hrs",
		"`purchase_orders`.`standard_labour_cost_per_hour`" => "standard_labour_cost_per_hour",
		"`purchase_orders`.`labour_charges`" => "labour_charges",
		"`purchase_orders`.`vat`" => "vat",
		"`purchase_orders`.`total_amount`" => "total_amount",
		"IF(    CHAR_LENGTH(`service1`.`workshop_name`), CONCAT_WS('',   `service1`.`workshop_name`), '') /* Workshop Name: */" => "workshop_name",
		"IF(    CHAR_LENGTH(`service2`.`service_id`), CONCAT_WS('',   `service2`.`service_id`), '') /* Work Order ID: */" => "work_order_id",
		"IF(    CHAR_LENGTH(`reception1`.`job_card_number`), CONCAT_WS('',   `reception1`.`job_card_number`), '') /* Job Card Number: */" => "job_card_number",
		"if(`purchase_orders`.`completion_date`,date_format(`purchase_orders`.`completion_date`,'%d/%m/%Y'),'')" => "completion_date",
		"`purchase_orders`.`comments`" => "comments",
		"`purchase_orders`.`upload_invoice`" => "upload_invoice",
		"if(`purchase_orders`.`date_captured`,date_format(`purchase_orders`.`date_captured`,'%d/%m/%Y'),'')" => "date_captured",
		"`purchase_orders`.`data_capturer`" => "data_capturer",
		"`purchase_orders`.`data_capturer_contact_email`" => "data_capturer_contact_email",
	];
	// Fields that can be filtered
	$x->QueryFieldsFilters = [
		"`purchase_orders`.`purchase_order_id`" => "Purchase Order ID:",
		"`purchase_orders`.`purchased_order_number`" => "Purchased Order Number:",
		"`purchase_orders`.`purchased_date`" => "Purchased Date:",
		"`purchase_orders`.`purchaser`" => "Purchaser:",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, ' '), '') /* Registration Number: */" => "Registration Number:",
		"IF(    CHAR_LENGTH(`body_type1`.`type_of_vehicle`), CONCAT_WS('',   `body_type1`.`type_of_vehicle`), '') /* Type of Vehicle: */" => "Type of Vehicle:",
		"IF(    CHAR_LENGTH(`manufacturer1`.`manufacturer_name`), CONCAT_WS('',   `manufacturer1`.`manufacturer_name`), '') /* Manufacturer: */" => "Manufacturer:",
		"`purchase_orders`.`service_type`" => "Service Type:",
		"IF(    CHAR_LENGTH(`service_categories1`.`service_category`), CONCAT_WS('',   `service_categories1`.`service_category`), '') /* Service Category: */" => "Service Category:",
		"`purchase_orders`.`service_item`" => "Service Item:",
		"`purchase_orders`.`upload_quotation`" => "Documents (Upload Quotation):",
		"`purchase_orders`.`due_date`" => "Due Date:",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant_type1`.`merchant_type`), CONCAT_WS('',   `merchant1`.`merchant_name`, '    |   and   |    ', `merchant_type1`.`merchant_type`), '') /* Merchant Name: */" => "Merchant Name:",
		"`purchase_orders`.`date_of_service`" => "Date of Service:",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`) || CHAR_LENGTH(`log_sheet1`.`fuel_log_sheet_id`), CONCAT_WS('',   `log_sheet1`.`closing_km`, '      |    and    |    ', `log_sheet1`.`fuel_log_sheet_id`), '') /* Odometer Reading (km): */" => "Odometer Reading (km):",
		"`purchase_orders`.`labour_category_1`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts1`.`part_number`), CONCAT_WS('',   `parts1`.`part_number`), '') /* Part Number (1): */" => "Part Number (1):",
		"IF(    CHAR_LENGTH(`parts2`.`part_name`), CONCAT_WS('',   `parts2`.`part_name`), '') /* Part Name (1): */" => "Part Name (1):",
		"IF(    CHAR_LENGTH(`manufacturer2`.`manufacturer_name`), CONCAT_WS('',   `manufacturer2`.`manufacturer_name`), '') /* Part Manufacturer Name (1): */" => "Part Manufacturer Name (1):",
		"`purchase_orders`.`quantity_1`" => "Quantity",
		"`purchase_orders`.`expense_of_item_1`" => "Expense Of Item 1 (R):",
		"`purchase_orders`.`labour_category_2`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts3`.`part_number`), CONCAT_WS('',   `parts3`.`part_number`), '') /* Part Number (2): */" => "Part Number (2):",
		"IF(    CHAR_LENGTH(`parts4`.`part_name`), CONCAT_WS('',   `parts4`.`part_name`), '') /* Part Name (2): */" => "Part Name (2):",
		"IF(    CHAR_LENGTH(`manufacturer3`.`manufacturer_name`), CONCAT_WS('',   `manufacturer3`.`manufacturer_name`), '') /* Part Manufacturer Name (2): */" => "Part Manufacturer Name (2):",
		"`purchase_orders`.`quantity_2`" => "Quantity",
		"`purchase_orders`.`expense_of_item_2`" => "Expense Of Item 2 (R):",
		"`purchase_orders`.`labour_category_3`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts5`.`part_number`), CONCAT_WS('',   `parts5`.`part_number`), '') /* Part Number (3): */" => "Part Number (3):",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (3): */" => "Part Name (3):",
		"IF(    CHAR_LENGTH(`manufacturer4`.`manufacturer_name`), CONCAT_WS('',   `manufacturer4`.`manufacturer_name`), '') /* Part Manufacturer Name (3): */" => "Part Manufacturer Name (3):",
		"`purchase_orders`.`quantity_3`" => "Quantity",
		"`purchase_orders`.`expense_of_item_3`" => "Expense Of Item 3 (R):",
		"`purchase_orders`.`labour_category_4`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts6`.`part_number`), CONCAT_WS('',   `parts6`.`part_number`), '') /* Part Number (4): */" => "Part Number (4):",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (4): */" => "Part Name (4):",
		"IF(    CHAR_LENGTH(`manufacturer5`.`manufacturer_name`), CONCAT_WS('',   `manufacturer5`.`manufacturer_name`), '') /* Part Manufacturer Name  (4): */" => "Part Manufacturer Name  (4):",
		"`purchase_orders`.`quantity_4`" => "Quantity",
		"`purchase_orders`.`expense_of_item_4`" => "Expense Of Item 4 (R):",
		"`purchase_orders`.`labour_category_5`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts7`.`part_number`), CONCAT_WS('',   `parts7`.`part_number`), '') /* Part Number (5): */" => "Part Number (5):",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (5): */" => "Part Name (5):",
		"IF(    CHAR_LENGTH(`manufacturer6`.`manufacturer_name`), CONCAT_WS('',   `manufacturer6`.`manufacturer_name`), '') /* Part Manufacturer Name (5): */" => "Part Manufacturer Name (5):",
		"`purchase_orders`.`quantity_5`" => "Quantity",
		"`purchase_orders`.`expense_of_item_5`" => "Expense Of Item 5 (R):",
		"`purchase_orders`.`labour_category_6`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts8`.`part_number`), CONCAT_WS('',   `parts8`.`part_number`), '') /* Part Number (6): */" => "Part Number (6):",
		"IF(    CHAR_LENGTH(`parts9`.`part_name`), CONCAT_WS('',   `parts9`.`part_name`), '') /* Part Name (6): */" => "Part Name (6):",
		"IF(    CHAR_LENGTH(`manufacturer7`.`manufacturer_name`), CONCAT_WS('',   `manufacturer7`.`manufacturer_name`), '') /* Part Manufacturer Name (6): */" => "Part Manufacturer Name (6):",
		"`purchase_orders`.`quantity_6`" => "Quantity",
		"`purchase_orders`.`expense_of_item_6`" => "Expense Of Item 6 (R):",
		"`purchase_orders`.`labour_category_7`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts10`.`part_number`), CONCAT_WS('',   `parts10`.`part_number`), '') /* Part Number (7): */" => "Part Number (7):",
		"IF(    CHAR_LENGTH(`parts11`.`part_name`), CONCAT_WS('',   `parts11`.`part_name`), '') /* Part Name (7): */" => "Part Name (7):",
		"IF(    CHAR_LENGTH(`manufacturer8`.`manufacturer_name`), CONCAT_WS('',   `manufacturer8`.`manufacturer_name`), '') /* Part Manufacturer Name (7): */" => "Part Manufacturer Name (7):",
		"`purchase_orders`.`quantity_7`" => "Quantity",
		"`purchase_orders`.`expense_of_item_7`" => "Expense Of Item 7 (R):",
		"`purchase_orders`.`labour_category_8`" => "Labour Category:",
		"IF(    CHAR_LENGTH(`parts12`.`part_number`), CONCAT_WS('',   `parts12`.`part_number`), '') /* Part Number (8): */" => "Part Number (8):",
		"IF(    CHAR_LENGTH(`parts13`.`part_number`), CONCAT_WS('',   `parts13`.`part_number`), '') /* Part Name (8): */" => "Part Name (8):",
		"IF(    CHAR_LENGTH(`manufacturer9`.`manufacturer_name`), CONCAT_WS('',   `manufacturer9`.`manufacturer_name`), '') /* Part Manufacturer Name (8): */" => "Part Manufacturer Name (8):",
		"`purchase_orders`.`expense_of_item_8`" => "Expense Of Item 8 (R):",
		"`purchase_orders`.`material_cost`" => "Material Cost (R);",
		"`purchase_orders`.`average_worktime_hrs`" => "Average Worktime Hrs:",
		"`purchase_orders`.`standard_labour_cost_per_hour`" => "Standard Labour Cost per Hour:",
		"`purchase_orders`.`labour_charges`" => "Labour Charges (R):",
		"`purchase_orders`.`vat`" => "Vat 15 % (R):",
		"`purchase_orders`.`total_amount`" => "Total Amount (R):",
		"IF(    CHAR_LENGTH(`service1`.`workshop_name`), CONCAT_WS('',   `service1`.`workshop_name`), '') /* Workshop Name: */" => "Workshop Name:",
		"IF(    CHAR_LENGTH(`service2`.`service_id`), CONCAT_WS('',   `service2`.`service_id`), '') /* Work Order ID: */" => "Work Order ID:",
		"IF(    CHAR_LENGTH(`reception1`.`job_card_number`), CONCAT_WS('',   `reception1`.`job_card_number`), '') /* Job Card Number: */" => "Job Card Number:",
		"`purchase_orders`.`completion_date`" => "Actual Completion Date:",
		"`purchase_orders`.`comments`" => "Comments:",
		"`purchase_orders`.`upload_invoice`" => "Documents (Upload Invoice):",
		"`purchase_orders`.`date_captured`" => "Date Captured:",
		"`purchase_orders`.`data_capturer`" => "Information Capture By  (Name & Surname):",
		"`purchase_orders`.`data_capturer_contact_email`" => "Data Capturer Contact e-Mail:",
	];

	// Fields that can be quick searched
	$x->QueryFieldsQS = [
		"`purchase_orders`.`purchase_order_id`" => "purchase_order_id",
		"`purchase_orders`.`purchased_order_number`" => "purchased_order_number",
		"if(`purchase_orders`.`purchased_date`,date_format(`purchase_orders`.`purchased_date`,'%d/%m/%Y'),'')" => "purchased_date",
		"`purchase_orders`.`purchaser`" => "purchaser",
		"IF(    CHAR_LENGTH(`gmt_fleet_register1`.`vehicle_registration_number`), CONCAT_WS('',   `gmt_fleet_register1`.`vehicle_registration_number`, ' '), '') /* Registration Number: */" => "vehicle_registration_number",
		"IF(    CHAR_LENGTH(`body_type1`.`type_of_vehicle`), CONCAT_WS('',   `body_type1`.`type_of_vehicle`), '') /* Type of Vehicle: */" => "type_of_vehicle",
		"IF(    CHAR_LENGTH(`manufacturer1`.`manufacturer_name`), CONCAT_WS('',   `manufacturer1`.`manufacturer_name`), '') /* Manufacturer: */" => "manufacturer",
		"`purchase_orders`.`service_type`" => "service_type",
		"IF(    CHAR_LENGTH(`service_categories1`.`service_category`), CONCAT_WS('',   `service_categories1`.`service_category`), '') /* Service Category: */" => "service_category",
		"`purchase_orders`.`service_item`" => "service_item",
		"`purchase_orders`.`upload_quotation`" => "upload_quotation",
		"if(`purchase_orders`.`due_date`,date_format(`purchase_orders`.`due_date`,'%d/%m/%Y'),'')" => "due_date",
		"IF(    CHAR_LENGTH(`merchant1`.`merchant_name`) || CHAR_LENGTH(`merchant_type1`.`merchant_type`), CONCAT_WS('',   `merchant1`.`merchant_name`, '    |   and   |    ', `merchant_type1`.`merchant_type`), '') /* Merchant Name: */" => "merchant_name",
		"DATE_FORMAT(`purchase_orders`.`date_of_service`, '%D %b %Y %l:%i%p')" => "date_of_service",
		"IF(    CHAR_LENGTH(`log_sheet1`.`closing_km`) || CHAR_LENGTH(`log_sheet1`.`fuel_log_sheet_id`), CONCAT_WS('',   `log_sheet1`.`closing_km`, '      |    and    |    ', `log_sheet1`.`fuel_log_sheet_id`), '') /* Odometer Reading (km): */" => "closing_km",
		"`purchase_orders`.`labour_category_1`" => "labour_category_1",
		"IF(    CHAR_LENGTH(`parts1`.`part_number`), CONCAT_WS('',   `parts1`.`part_number`), '') /* Part Number (1): */" => "part_number_1",
		"IF(    CHAR_LENGTH(`parts2`.`part_name`), CONCAT_WS('',   `parts2`.`part_name`), '') /* Part Name (1): */" => "part_name_1",
		"IF(    CHAR_LENGTH(`manufacturer2`.`manufacturer_name`), CONCAT_WS('',   `manufacturer2`.`manufacturer_name`), '') /* Part Manufacturer Name (1): */" => "part_manufacturer_name_1",
		"`purchase_orders`.`quantity_1`" => "quantity_1",
		"`purchase_orders`.`expense_of_item_1`" => "expense_of_item_1",
		"`purchase_orders`.`labour_category_2`" => "labour_category_2",
		"IF(    CHAR_LENGTH(`parts3`.`part_number`), CONCAT_WS('',   `parts3`.`part_number`), '') /* Part Number (2): */" => "part_number_2",
		"IF(    CHAR_LENGTH(`parts4`.`part_name`), CONCAT_WS('',   `parts4`.`part_name`), '') /* Part Name (2): */" => "part_name_2",
		"IF(    CHAR_LENGTH(`manufacturer3`.`manufacturer_name`), CONCAT_WS('',   `manufacturer3`.`manufacturer_name`), '') /* Part Manufacturer Name (2): */" => "part_manufacturer_name_2",
		"`purchase_orders`.`quantity_2`" => "quantity_2",
		"`purchase_orders`.`expense_of_item_2`" => "expense_of_item_2",
		"`purchase_orders`.`labour_category_3`" => "labour_category_3",
		"IF(    CHAR_LENGTH(`parts5`.`part_number`), CONCAT_WS('',   `parts5`.`part_number`), '') /* Part Number (3): */" => "part_number_3",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (3): */" => "part_name_3",
		"IF(    CHAR_LENGTH(`manufacturer4`.`manufacturer_name`), CONCAT_WS('',   `manufacturer4`.`manufacturer_name`), '') /* Part Manufacturer Name (3): */" => "part_manufacturer_name_3",
		"`purchase_orders`.`quantity_3`" => "quantity_3",
		"`purchase_orders`.`expense_of_item_3`" => "expense_of_item_3",
		"`purchase_orders`.`labour_category_4`" => "labour_category_4",
		"IF(    CHAR_LENGTH(`parts6`.`part_number`), CONCAT_WS('',   `parts6`.`part_number`), '') /* Part Number (4): */" => "part_number_4",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (4): */" => "part_name_4",
		"IF(    CHAR_LENGTH(`manufacturer5`.`manufacturer_name`), CONCAT_WS('',   `manufacturer5`.`manufacturer_name`), '') /* Part Manufacturer Name  (4): */" => "part_manufacturer_name_4",
		"`purchase_orders`.`quantity_4`" => "quantity_4",
		"`purchase_orders`.`expense_of_item_4`" => "expense_of_item_4",
		"`purchase_orders`.`labour_category_5`" => "labour_category_5",
		"IF(    CHAR_LENGTH(`parts7`.`part_number`), CONCAT_WS('',   `parts7`.`part_number`), '') /* Part Number (5): */" => "part_number_5",
		"IF(    CHAR_LENGTH(`parts1`.`part_name`), CONCAT_WS('',   `parts1`.`part_name`), '') /* Part Name (5): */" => "part_name_5",
		"IF(    CHAR_LENGTH(`manufacturer6`.`manufacturer_name`), CONCAT_WS('',   `manufacturer6`.`manufacturer_name`), '') /* Part Manufacturer Name (5): */" => "part_manufacturer_name_5",
		"`purchase_orders`.`quantity_5`" => "quantity_5",
		"`purchase_orders`.`expense_of_item_5`" => "expense_of_item_5",
		"`purchase_orders`.`labour_category_6`" => "labour_category_6",
		"IF(    CHAR_LENGTH(`parts8`.`part_number`), CONCAT_WS('',   `parts8`.`part_number`), '') /* Part Number (6): */" => "part_number_6",
		"IF(    CHAR_LENGTH(`parts9`.`part_name`), CONCAT_WS('',   `parts9`.`part_name`), '') /* Part Name (6): */" => "part_name_6",
		"IF(    CHAR_LENGTH(`manufacturer7`.`manufacturer_name`), CONCAT_WS('',   `manufacturer7`.`manufacturer_name`), '') /* Part Manufacturer Name (6): */" => "part_manufacturer_name_6",
		"`purchase_orders`.`quantity_6`" => "quantity_6",
		"`purchase_orders`.`expense_of_item_6`" => "expense_of_item_6",
		"`purchase_orders`.`labour_category_7`" => "labour_category_7",
		"IF(    CHAR_LENGTH(`parts10`.`part_number`), CONCAT_WS('',   `parts10`.`part_number`), '') /* Part Number (7): */" => "part_number_7",
		"IF(    CHAR_LENGTH(`parts11`.`part_name`), CONCAT_WS('',   `parts11`.`part_name`), '') /* Part Name (7): */" => "part_name_7",
		"IF(    CHAR_LENGTH(`manufacturer8`.`manufacturer_name`), CONCAT_WS('',   `manufacturer8`.`manufacturer_name`), '') /* Part Manufacturer Name (7): */" => "part_manufacturer_name_7",
		"`purchase_orders`.`quantity_7`" => "quantity_7",
		"`purchase_orders`.`expense_of_item_7`" => "expense_of_item_7",
		"`purchase_orders`.`labour_category_8`" => "labour_category_8",
		"IF(    CHAR_LENGTH(`parts12`.`part_number`), CONCAT_WS('',   `parts12`.`part_number`), '') /* Part Number (8): */" => "part_number_8",
		"IF(    CHAR_LENGTH(`parts13`.`part_number`), CONCAT_WS('',   `parts13`.`part_number`), '') /* Part Name (8): */" => "part_name_8",
		"IF(    CHAR_LENGTH(`manufacturer9`.`manufacturer_name`), CONCAT_WS('',   `manufacturer9`.`manufacturer_name`), '') /* Part Manufacturer Name (8): */" => "part_manufacturer_name_8",
		"`purchase_orders`.`expense_of_item_8`" => "expense_of_item_8",
		"`purchase_orders`.`material_cost`" => "material_cost",
		"`purchase_orders`.`average_worktime_hrs`" => "average_worktime_hrs",
		"`purchase_orders`.`standard_labour_cost_per_hour`" => "standard_labour_cost_per_hour",
		"`purchase_orders`.`labour_charges`" => "labour_charges",
		"`purchase_orders`.`vat`" => "vat",
		"`purchase_orders`.`total_amount`" => "total_amount",
		"IF(    CHAR_LENGTH(`service1`.`workshop_name`), CONCAT_WS('',   `service1`.`workshop_name`), '') /* Workshop Name: */" => "workshop_name",
		"IF(    CHAR_LENGTH(`service2`.`service_id`), CONCAT_WS('',   `service2`.`service_id`), '') /* Work Order ID: */" => "work_order_id",
		"IF(    CHAR_LENGTH(`reception1`.`job_card_number`), CONCAT_WS('',   `reception1`.`job_card_number`), '') /* Job Card Number: */" => "job_card_number",
		"if(`purchase_orders`.`completion_date`,date_format(`purchase_orders`.`completion_date`,'%d/%m/%Y'),'')" => "completion_date",
		"`purchase_orders`.`comments`" => "comments",
		"`purchase_orders`.`upload_invoice`" => "upload_invoice",
		"if(`purchase_orders`.`date_captured`,date_format(`purchase_orders`.`date_captured`,'%d/%m/%Y'),'')" => "date_captured",
		"`purchase_orders`.`data_capturer`" => "data_capturer",
		"`purchase_orders`.`data_capturer_contact_email`" => "data_capturer_contact_email",
	];

	// Lookup fields that can be used as filterers
	$x->filterers = ['vehicle_registration_number' => 'Registration Number:', 'manufacturer' => 'Manufacturer:', 'service_category' => 'Service Category:', 'merchant_name' => 'Merchant Name:', 'closing_km' => 'Odometer Reading (km):', 'part_number_1' => 'Part Number (1):', 'part_name_1' => 'Part Name (1):', 'part_manufacturer_name_1' => 'Part Manufacturer Name (1):', 'part_number_2' => 'Part Number (2):', 'part_name_2' => 'Part Name (2):', 'part_manufacturer_name_2' => 'Part Manufacturer Name (2):', 'part_number_3' => 'Part Number (3):', 'part_manufacturer_name_3' => 'Part Manufacturer Name (3):', 'part_number_4' => 'Part Number (4):', 'part_manufacturer_name_4' => 'Part Manufacturer Name  (4):', 'part_number_5' => 'Part Number (5):', 'part_manufacturer_name_5' => 'Part Manufacturer Name (5):', 'part_number_6' => 'Part Number (6):', 'part_name_6' => 'Part Name (6):', 'part_manufacturer_name_6' => 'Part Manufacturer Name (6):', 'part_number_7' => 'Part Number (7):', 'part_name_7' => 'Part Name (7):', 'part_manufacturer_name_7' => 'Part Manufacturer Name (7):', 'part_number_8' => 'Part Number (8):', 'part_name_8' => 'Part Name (8):', 'part_manufacturer_name_8' => 'Part Manufacturer Name (8):', 'workshop_name' => 'Workshop Name:', 'work_order_id' => 'Work Order ID:', 'job_card_number' => 'Job Card Number:', ];

	$x->QueryFrom = "`purchase_orders` LEFT JOIN `gmt_fleet_register` as gmt_fleet_register1 ON `gmt_fleet_register1`.`fleet_asset_id`=`purchase_orders`.`vehicle_registration_number` LEFT JOIN `manufacturer` as manufacturer1 ON `manufacturer1`.`manufacturer_id`=`purchase_orders`.`manufacturer` LEFT JOIN `service_categories` as service_categories1 ON `service_categories1`.`service_categories_id`=`purchase_orders`.`service_category` LEFT JOIN `merchant` as merchant1 ON `merchant1`.`merchant_id`=`purchase_orders`.`merchant_name` LEFT JOIN `merchant_type` as merchant_type1 ON `merchant_type1`.`merchant_type_id`=`merchant1`.`merchant_type` LEFT JOIN `log_sheet` as log_sheet1 ON `log_sheet1`.`fuel_log_sheet_id`=`purchase_orders`.`closing_km` LEFT JOIN `parts` as parts1 ON `parts1`.`parts_id`=`purchase_orders`.`part_number_1` LEFT JOIN `parts` as parts2 ON `parts2`.`parts_id`=`purchase_orders`.`part_name_1` LEFT JOIN `manufacturer` as manufacturer2 ON `manufacturer2`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_1` LEFT JOIN `parts` as parts3 ON `parts3`.`parts_id`=`purchase_orders`.`part_number_2` LEFT JOIN `parts` as parts4 ON `parts4`.`parts_id`=`purchase_orders`.`part_name_2` LEFT JOIN `manufacturer` as manufacturer3 ON `manufacturer3`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_2` LEFT JOIN `parts` as parts5 ON `parts5`.`parts_id`=`purchase_orders`.`part_number_3` LEFT JOIN `manufacturer` as manufacturer4 ON `manufacturer4`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_3` LEFT JOIN `parts` as parts6 ON `parts6`.`parts_id`=`purchase_orders`.`part_number_4` LEFT JOIN `manufacturer` as manufacturer5 ON `manufacturer5`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_4` LEFT JOIN `parts` as parts7 ON `parts7`.`parts_id`=`purchase_orders`.`part_number_5` LEFT JOIN `manufacturer` as manufacturer6 ON `manufacturer6`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_5` LEFT JOIN `parts` as parts8 ON `parts8`.`parts_id`=`purchase_orders`.`part_number_6` LEFT JOIN `parts` as parts9 ON `parts9`.`parts_id`=`purchase_orders`.`part_name_6` LEFT JOIN `manufacturer` as manufacturer7 ON `manufacturer7`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_6` LEFT JOIN `parts` as parts10 ON `parts10`.`parts_id`=`purchase_orders`.`part_number_7` LEFT JOIN `parts` as parts11 ON `parts11`.`parts_id`=`purchase_orders`.`part_name_7` LEFT JOIN `manufacturer` as manufacturer8 ON `manufacturer8`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_7` LEFT JOIN `parts` as parts12 ON `parts12`.`parts_id`=`purchase_orders`.`part_number_8` LEFT JOIN `parts` as parts13 ON `parts13`.`parts_id`=`purchase_orders`.`part_name_8` LEFT JOIN `manufacturer` as manufacturer9 ON `manufacturer9`.`manufacturer_id`=`purchase_orders`.`part_manufacturer_name_8` LEFT JOIN `service` as service1 ON `service1`.`service_id`=`purchase_orders`.`workshop_name` LEFT JOIN `service` as service2 ON `service2`.`service_id`=`purchase_orders`.`work_order_id` LEFT JOIN `reception` as reception1 ON `reception1`.`reception_user_id`=`purchase_orders`.`job_card_number` LEFT JOIN `body_type` as body_type1 ON `body_type1`.`body_type_id`=`gmt_fleet_register1`.`type_of_vehicle` ";
	$x->QueryWhere = '';
	$x->QueryOrder = '';

	$x->AllowSelection = 1;
	$x->HideTableView = ($perm['view'] == 0 ? 1 : 0);
	$x->AllowDelete = $perm['delete'];
	$x->AllowMassDelete = (getLoggedAdmin() !== false);
	$x->AllowInsert = $perm['insert'];
	$x->AllowUpdate = $perm['edit'];
	$x->SeparateDV = 1;
	$x->AllowDeleteOfParents = 0;
	$x->AllowFilters = 1;
	$x->AllowSavingFilters = (getLoggedAdmin() !== false);
	$x->AllowSorting = 1;
	$x->AllowNavigation = 1;
	$x->AllowPrinting = 1;
	$x->AllowPrintingDV = 1;
	$x->AllowCSV = 1;
	$x->RecordsPerPage = 25;
	$x->QuickSearch = 1;
	$x->QuickSearchText = $Translation['quick search'];
	$x->ScriptFileName = 'purchase_orders_view.php';
	$x->RedirectAfterInsert = 'purchase_orders_view.php?SelectedID=#ID#';
	$x->TableTitle = 'Purchase Orders:';
	$x->TableIcon = 'resources/table_icons/group_data.png';
	$x->PrimaryKey = '`purchase_orders`.`purchase_order_id`';

	$x->ColWidth = [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, ];
	$x->ColCaption = ['Purchase Order ID:', 'Purchased Order Number:', 'Purchased Date:', 'Purchaser:', 'Registration Number:', 'Type of Vehicle:', 'Manufacturer:', 'Service Type:', 'Service Category:', 'Service Item:', 'Documents (Upload Quotation):', 'Due Date:', 'Merchant Name:', 'Date of Service:', 'Odometer Reading (km):', 'Labour Category:', 'Part Number (1):', 'Part Name (1):', 'Part Manufacturer Name (1):', 'Quantity', 'Expense Of Item 1 (R):', 'Labour Category:', 'Part Number (2):', 'Part Name (2):', 'Part Manufacturer Name (2):', 'Quantity', 'Expense Of Item 2 (R):', 'Labour Category:', 'Part Number (3):', 'Part Name (3):', 'Part Manufacturer Name (3):', 'Quantity', 'Expense Of Item 3 (R):', 'Labour Category:', 'Part Number (4):', 'Part Name (4):', 'Part Manufacturer Name  (4):', 'Quantity', 'Expense Of Item 4 (R):', 'Labour Category:', 'Part Number (5):', 'Part Name (5):', 'Part Manufacturer Name (5):', 'Quantity', 'Expense Of Item 5 (R):', 'Labour Category:', 'Part Number (6):', 'Part Name (6):', 'Part Manufacturer Name (6):', 'Quantity', 'Expense Of Item 6 (R):', 'Labour Category:', 'Part Number (7):', 'Part Name (7):', 'Part Manufacturer Name (7):', 'Quantity', 'Expense Of Item 7 (R):', 'Labour Category:', 'Part Number (8):', 'Part Name (8):', 'Part Manufacturer Name (8):', 'Expense Of Item 8 (R):', 'Material Cost (R);', 'Average Worktime Hrs:', 'Standard Labour Cost per Hour:', 'Labour Charges (R):', 'Vat 15 % (R):', 'Total Amount (R):', 'Workshop Name:', 'Work Order ID:', 'Job Card Number:', 'Actual Completion Date:', 'Comments:', 'Documents (Upload Invoice):', 'Date Captured:', 'Information Capture By  (Name & Surname):', 'Data Capturer Contact e-Mail:', ];
	$x->ColFieldName = ['purchase_order_id', 'purchased_order_number', 'purchased_date', 'purchaser', 'vehicle_registration_number', 'type_of_vehicle', 'manufacturer', 'service_type', 'service_category', 'service_item', 'upload_quotation', 'due_date', 'merchant_name', 'date_of_service', 'closing_km', 'labour_category_1', 'part_number_1', 'part_name_1', 'part_manufacturer_name_1', 'quantity_1', 'expense_of_item_1', 'labour_category_2', 'part_number_2', 'part_name_2', 'part_manufacturer_name_2', 'quantity_2', 'expense_of_item_2', 'labour_category_3', 'part_number_3', 'part_name_3', 'part_manufacturer_name_3', 'quantity_3', 'expense_of_item_3', 'labour_category_4', 'part_number_4', 'part_name_4', 'part_manufacturer_name_4', 'quantity_4', 'expense_of_item_4', 'labour_category_5', 'part_number_5', 'part_name_5', 'part_manufacturer_name_5', 'quantity_5', 'expense_of_item_5', 'labour_category_6', 'part_number_6', 'part_name_6', 'part_manufacturer_name_6', 'quantity_6', 'expense_of_item_6', 'labour_category_7', 'part_number_7', 'part_name_7', 'part_manufacturer_name_7', 'quantity_7', 'expense_of_item_7', 'labour_category_8', 'part_number_8', 'part_name_8', 'part_manufacturer_name_8', 'expense_of_item_8', 'material_cost', 'average_worktime_hrs', 'standard_labour_cost_per_hour', 'labour_charges', 'vat', 'total_amount', 'workshop_name', 'work_order_id', 'job_card_number', 'completion_date', 'comments', 'upload_invoice', 'date_captured', 'data_capturer', 'data_capturer_contact_email', ];
	$x->ColNumber  = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, ];

	// template paths below are based on the app main directory
	$x->Template = 'templates/purchase_orders_templateTV.html';
	$x->SelectedTemplate = 'templates/purchase_orders_templateTVS.html';
	$x->TemplateDV = 'templates/purchase_orders_templateDV.html';
	$x->TemplateDVP = 'templates/purchase_orders_templateDVP.html';

	$x->ShowTableHeader = 1;
	$x->TVClasses = "";
	$x->DVClasses = "";
	$x->HasCalculatedFields = false;
	$x->AllowConsoleLog = false;
	$x->AllowDVNavigation = true;

	// hook: purchase_orders_init
	$render = true;
	if(function_exists('purchase_orders_init')) {
		$args = [];
		$render = purchase_orders_init($x, getMemberInfo(), $args);
	}

	if($render) $x->Render();

	// column sums
	if(strpos($x->HTML, '<!-- tv data below -->')) {
		// if printing multi-selection TV, calculate the sum only for the selected records
		$record_selector = Request::val('record_selector');
		if(Request::val('Print_x') && is_array($record_selector)) {
			$QueryWhere = '';
			foreach($record_selector as $id) {   // get selected records
				if($id != '') $QueryWhere .= "'" . makeSafe($id) . "',";
			}
			if($QueryWhere != '') {
				$QueryWhere = 'where `purchase_orders`.`purchase_order_id` in ('.substr($QueryWhere, 0, -1).')';
			} else { // if no selected records, write the where clause to return an empty result
				$QueryWhere = 'where 1=0';
			}
		} else {
			$QueryWhere = $x->QueryWhere;
		}

		$sumQuery = "SELECT SUM(`purchase_orders`.`total_amount`) FROM {$x->QueryFrom} {$QueryWhere}";
		$res = sql($sumQuery, $eo);
		if($row = db_fetch_row($res)) {
			$sumRow = '<tr class="success sum">';
			if(!Request::val('Print_x')) $sumRow .= '<th class="text-center sum">&sum;</th>';
			$sumRow .= '<td class="purchase_orders-purchase_order_id sum"></td>';
			$sumRow .= '<td class="purchase_orders-purchased_order_number sum"></td>';
			$sumRow .= '<td class="purchase_orders-purchased_date sum"></td>';
			$sumRow .= '<td class="purchase_orders-purchaser sum"></td>';
			$sumRow .= '<td class="purchase_orders-vehicle_registration_number sum"></td>';
			$sumRow .= '<td class="purchase_orders-type_of_vehicle sum"></td>';
			$sumRow .= '<td class="purchase_orders-manufacturer sum"></td>';
			$sumRow .= '<td class="purchase_orders-service_type sum"></td>';
			$sumRow .= '<td class="purchase_orders-service_category sum"></td>';
			$sumRow .= '<td class="purchase_orders-service_item sum"></td>';
			$sumRow .= '<td class="purchase_orders-upload_quotation sum"></td>';
			$sumRow .= '<td class="purchase_orders-due_date sum"></td>';
			$sumRow .= '<td class="purchase_orders-merchant_name sum"></td>';
			$sumRow .= '<td class="purchase_orders-date_of_service sum"></td>';
			$sumRow .= '<td class="purchase_orders-closing_km sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_1 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_2 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_3 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_4 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_5 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_6 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-quantity_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_7 sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_category_8 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_number_8 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_name_8 sum"></td>';
			$sumRow .= '<td class="purchase_orders-part_manufacturer_name_8 sum"></td>';
			$sumRow .= '<td class="purchase_orders-expense_of_item_8 sum"></td>';
			$sumRow .= '<td class="purchase_orders-material_cost sum"></td>';
			$sumRow .= '<td class="purchase_orders-average_worktime_hrs sum"></td>';
			$sumRow .= '<td class="purchase_orders-standard_labour_cost_per_hour sum"></td>';
			$sumRow .= '<td class="purchase_orders-labour_charges sum"></td>';
			$sumRow .= '<td class="purchase_orders-vat sum"></td>';
			$sumRow .= "<td class=\"purchase_orders-total_amount text-right sum locale-float\">{$row[0]}</td>";
			$sumRow .= '<td class="purchase_orders-workshop_name sum"></td>';
			$sumRow .= '<td class="purchase_orders-work_order_id sum"></td>';
			$sumRow .= '<td class="purchase_orders-job_card_number sum"></td>';
			$sumRow .= '<td class="purchase_orders-completion_date sum"></td>';
			$sumRow .= '<td class="purchase_orders-comments sum"></td>';
			$sumRow .= '<td class="purchase_orders-upload_invoice sum"></td>';
			$sumRow .= '<td class="purchase_orders-date_captured sum"></td>';
			$sumRow .= '<td class="purchase_orders-data_capturer sum"></td>';
			$sumRow .= '<td class="purchase_orders-data_capturer_contact_email sum"></td>';
			$sumRow .= '</tr>';

			$x->HTML = str_replace('<!-- tv data below -->', '', $x->HTML);
			$x->HTML = str_replace('<!-- tv data above -->', $sumRow, $x->HTML);
		}
	}

	// hook: purchase_orders_header
	$headerCode = '';
	if(function_exists('purchase_orders_header')) {
		$args = [];
		$headerCode = purchase_orders_header($x->ContentType, getMemberInfo(), $args);
	}

	if(!$headerCode) {
		include_once(__DIR__ . '/header.php'); 
	} else {
		ob_start();
		include_once(__DIR__ . '/header.php');
		echo str_replace('<%%HEADER%%>', ob_get_clean(), $headerCode);
	}

	echo $x->HTML;

	// hook: purchase_orders_footer
	$footerCode = '';
	if(function_exists('purchase_orders_footer')) {
		$args = [];
		$footerCode = purchase_orders_footer($x->ContentType, getMemberInfo(), $args);
	}

	if(!$footerCode) {
		include_once(__DIR__ . '/footer.php'); 
	} else {
		ob_start();
		include_once(__DIR__ . '/footer.php');
		echo str_replace('<%%FOOTER%%>', ob_get_clean(), $footerCode);
	}
